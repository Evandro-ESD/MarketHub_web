<section class="cart" *ngIf="itens().length; else vazio">
	<h2>Seu Carrinho ({{ totalQtd() }} itens)</h2>
		<table class="cart-table">
		<thead>
			<tr>
					<th>Produto</th>
				<th>Preço</th>
				<th>Qtd</th>
				<th>Subtotal</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			@for (item of itens(); track item.id_produto) {
				<tr>
						<td class="prod-col">
							<div class="prod-info">
								<img *ngIf="item.foto" [src]="item.foto" class="thumb" alt="{{ item.nome }}" />
								<span class="nome">{{ item.nome }}</span>
							</div>
						</td>
					<td>R$ {{ item.preco | number:'1.2-2' }}</td>
					<td>
						<input type="number" min="1" [value]="item.quantidade" (change)="atualizar(item.id_produto, $any($event.target).valueAsNumber || 1)" />
					</td>
					<td>R$ {{ (item.preco * item.quantidade) | number:'1.2-2' }}</td>
					<td><button (click)="remover(item.id_produto)" class="remove">✕</button></td>
				</tr>
			}
		</tbody>
	</table>
	<div class="cart-actions">
		<div class="total">Total: <strong>R$ {{ total() | number:'1.2-2' }}</strong></div>
		<div class="buttons">
			<button (click)="limpar()" class="secondary" [disabled]="loading()">Limpar</button>
			<button (click)="checkout()" [disabled]="loading()" class="primary">
				{{ loading() ? 'Processando...' : 'Finalizar Pedido' }}
			</button>
		</div>
	</div>
</section>

<ng-template #vazio>
	<div class="empty">
		<p>Seu carrinho está vazio.</p>
		<a routerLink="home">Voltar às compras</a>
	</div>
</ng-template>
